<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 27.2.

Copyright (C) 1990-1996, 1998-2021 Free Software Foundation,
Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<!-- Created by GNU Texinfo 6.7, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<link rev="made" href="mailto:bug-gnu-emacs@gnu.org">
<link rel="icon" type="image/png" href="/graphics/gnu-head-mini.png">
<meta name="ICBM" content="42.256233,-71.006581">
<meta name="DC.title" content="gnu.org">

<style type="text/css">
@import url('/software/emacs/manual.css');
</style>
</head>

<body lang="en">
<span id="Formatting-Strings"></span><div class="header" style="background-color:#DDDDFF">
<p>
Next: <a href="Custom-Format-Strings.html" accesskey="n" rel="next">Custom Format Strings</a>, Previous: <a href="String-Conversion.html" accesskey="p" rel="prev">String Conversion</a>, Up: <a href="Strings-and-Characters.html" accesskey="u" rel="up">Strings and Characters</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>

<span id="Formatting-Strings-1"></span><h3 class="section">4.7 Formatting Strings</h3>
<span id="index-formatting-strings"></span>
<span id="index-strings_002c-formatting-them"></span>

<p><em>Formatting</em> means constructing a string by substituting
computed values at various places in a constant string.  This constant
string controls how the other values are printed, as well as where
they appear; it is called a <em>format string</em>.
</p>
<p>Formatting is often useful for computing messages to be displayed.  In
fact, the functions <code>message</code> and <code>error</code> provide the same
formatting feature described here; they differ from <code>format-message</code> only
in how they use the result of formatting.
</p>
<dl>
<dt id="index-format">Function: <strong>format</strong> <em>string &amp;rest objects</em></dt>
<dd><p>This function returns a string equal to <var>string</var>, replacing any format
specifications with encodings of the corresponding <var>objects</var>.  The
arguments <var>objects</var> are the computed values to be formatted.
</p>
<p>The characters in <var>string</var>, other than the format specifications,
are copied directly into the output, including their text properties,
if any.  Any text properties of the format specifications are copied
to the produced string representations of the argument <var>objects</var>.
</p>
<p>The output string need not be newly-allocated.  For example, if
<code>x</code> is the string <code>&quot;foo&quot;</code>, the expressions <code>(eq x
(format x))</code> and <code>(eq x (format &quot;%s&quot; x))</code> might both yield
<code>t</code>.
</p></dd></dl>

<dl>
<dt id="index-format_002dmessage">Function: <strong>format-message</strong> <em>string &amp;rest objects</em></dt>
<dd><span id="index-curved-quotes_002c-in-formatted-messages"></span>
<span id="index-curly-quotes_002c-in-formatted-messages"></span>
<p>This function acts like <code>format</code>, except it also converts any
grave accents (<tt>`</tt>) and apostrophes (<tt>'</tt>) in <var>string</var> as per the
value of <code>text-quoting-style</code>.
</p>
<p>Typically grave accent and apostrophe in the format translate to
matching curved quotes, e.g., <tt>&quot;Missing `%s'&quot;</tt> might result in
<tt>&quot;Missing ‘foo’&quot;</tt>.  See <a href="Text-Quoting-Style.html">Text Quoting Style</a>, for how to influence
or inhibit this translation.
</p></dd></dl>

<span id="index-_0025-in-format"></span>
<span id="index-format-specification"></span>
<p>A format specification is a sequence of characters beginning with a
&lsquo;<samp>%</samp>&rsquo;.  Thus, if there is a &lsquo;<samp>%d</samp>&rsquo; in <var>string</var>, the
<code>format</code> function replaces it with the printed representation of
one of the values to be formatted (one of the arguments <var>objects</var>).
For example:
</p>
<div class="example">
<pre class="example">(format &quot;The value of fill-column is %d.&quot; fill-column)
     &rArr; &quot;The value of fill-column is 72.&quot;
</pre></div>

<p>Since <code>format</code> interprets &lsquo;<samp>%</samp>&rsquo; characters as format
specifications, you should <em>never</em> pass an arbitrary string as
the first argument.  This is particularly true when the string is
generated by some Lisp code.  Unless the string is <em>known</em> to
never include any &lsquo;<samp>%</samp>&rsquo; characters, pass <code>&quot;%s&quot;</code>, described
below, as the first argument, and the string as the second, like this:
</p>
<div class="example">
<pre class="example">  (format &quot;%s&quot; <var>arbitrary-string</var>)
</pre></div>

<p>Certain format specifications require values of particular types.  If
you supply a value that doesn&rsquo;t fit the requirements, an error is
signaled.
</p>
<p>Here is a table of valid format specifications:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>%s</samp>&rsquo;</dt>
<dd><p>Replace the specification with the printed representation of the object,
made without quoting (that is, using <code>princ</code>, not
<code>prin1</code>&mdash;see <a href="Output-Functions.html">Output Functions</a>).  Thus, strings are represented
by their contents alone, with no &lsquo;<samp>&quot;</samp>&rsquo; characters, and symbols appear
without &lsquo;<samp>\</samp>&rsquo; characters.
</p>
<p>If the object is a string, its text properties are
copied into the output.  The text properties of the &lsquo;<samp>%s</samp>&rsquo; itself
are also copied, but those of the object take priority.
</p>
</dd>
<dt>&lsquo;<samp>%S</samp>&rsquo;</dt>
<dd><p>Replace the specification with the printed representation of the object,
made with quoting (that is, using <code>prin1</code>&mdash;see <a href="Output-Functions.html">Output Functions</a>).  Thus, strings are enclosed in &lsquo;<samp>&quot;</samp>&rsquo; characters, and
&lsquo;<samp>\</samp>&rsquo; characters appear where necessary before special characters.
</p>
</dd>
<dt>&lsquo;<samp>%o</samp>&rsquo;</dt>
<dd><span id="index-integer-to-octal"></span>
<p>Replace the specification with the base-eight representation of an
integer.  Negative integers are formatted in a platform-dependent
way.  The object can also be a floating-point number that is formatted
as an integer, dropping any fraction.
</p>
</dd>
<dt>&lsquo;<samp>%d</samp>&rsquo;</dt>
<dd><p>Replace the specification with the base-ten representation of a signed
integer.  The object can also be a floating-point number that is
formatted as an integer, dropping any fraction.
</p>
</dd>
<dt>&lsquo;<samp>%x</samp>&rsquo;</dt>
<dt>&lsquo;<samp>%X</samp>&rsquo;</dt>
<dd><span id="index-integer-to-hexadecimal"></span>
<p>Replace the specification with the base-sixteen representation of an
integer.  Negative integers are formatted in a platform-dependent
way.  &lsquo;<samp>%x</samp>&rsquo; uses lower case and &lsquo;<samp>%X</samp>&rsquo; uses upper
case.  The object can also be a floating-point number that is
formatted as an integer, dropping any fraction.
</p>
</dd>
<dt>&lsquo;<samp>%c</samp>&rsquo;</dt>
<dd><p>Replace the specification with the character which is the value given.
</p>
</dd>
<dt>&lsquo;<samp>%e</samp>&rsquo;</dt>
<dd><p>Replace the specification with the exponential notation for a
floating-point number.
</p>
</dd>
<dt>&lsquo;<samp>%f</samp>&rsquo;</dt>
<dd><p>Replace the specification with the decimal-point notation for a
floating-point number.
</p>
</dd>
<dt>&lsquo;<samp>%g</samp>&rsquo;</dt>
<dd><p>Replace the specification with notation for a floating-point number,
using either exponential notation or decimal-point notation.  The
exponential notation is used if the exponent would be less than -4 or
greater than or equal to the precision (default: 6).  By default,
trailing zeros are removed from the fractional portion of the result
and a decimal-point character appears only if it is followed by a
digit.
</p>
</dd>
<dt>&lsquo;<samp>%%</samp>&rsquo;</dt>
<dd><p>Replace the specification with a single &lsquo;<samp>%</samp>&rsquo;.  This format
specification is unusual in that its only form is plain
&lsquo;<samp>%%</samp>&rsquo; and that it does not use a value.  For example,
<code>(format &quot;%% %d&quot; 30)</code> returns <code>&quot;% 30&quot;</code>.
</p></dd>
</dl>

<p>Any other format character results in an &lsquo;<samp>Invalid format
operation</samp>&rsquo; error.
</p>
<p>Here are several examples, which assume the typical
<code>text-quoting-style</code> settings:
</p>
<div class="example">
<pre class="example">(format &quot;The octal value of %d is %o,
         and the hex value is %x.&quot; 18 18 18)
     &rArr; &quot;The octal value of 18 is 22,
         and the hex value is 12.&quot;

(format-message
 &quot;The name of this buffer is ‘%s’.&quot; (buffer-name))
     &rArr; &quot;The name of this buffer is ‘strings.texi’.&quot;

(format-message
 &quot;The buffer object prints as `%s'.&quot; (current-buffer))
     &rArr; &quot;The buffer object prints as ‘strings.texi’.&quot;
</pre></div>

<p>By default, format specifications correspond to successive values from
<var>objects</var>.  Thus, the first format specification in <var>string</var>
uses the first such value, the second format specification uses the
second such value, and so on.  Any extra format specifications (those
for which there are no corresponding values) cause an error.  Any
extra values to be formatted are ignored.
</p>
<span id="index-field-numbers-in-format-spec"></span>
<p>A format specification can have a <em>field number</em>, which is a
decimal number immediately after the initial &lsquo;<samp>%</samp>&rsquo;, followed by a
literal dollar sign &lsquo;<samp>$</samp>&rsquo;.  It causes the format specification to
convert the argument with the given number instead of the next
argument.  Field numbers start at 1.  A format can contain either
numbered or unnumbered format specifications but not both, except that
&lsquo;<samp>%%</samp>&rsquo; can be mixed with numbered specifications.
</p>
<div class="example">
<pre class="example">(format &quot;%2$s, %3$s, %%, %1$s&quot; &quot;x&quot; &quot;y&quot; &quot;z&quot;)
     &rArr; &quot;y, z, %, x&quot;
</pre></div>

<span id="index-flags-in-format-specifications"></span>
<p>After the &lsquo;<samp>%</samp>&rsquo; and any field number, you can put certain
<em>flag characters</em>.
</p>
<p>The flag &lsquo;<samp>+</samp>&rsquo; inserts a plus sign before a nonnegative number, so
that it always has a sign.  A space character as flag inserts a space
before a nonnegative number.  (Otherwise, nonnegative numbers start with the
first digit.)  These flags are useful for ensuring that nonnegative
and negative numbers use the same number of columns.  They are
ignored except for &lsquo;<samp>%d</samp>&rsquo;, &lsquo;<samp>%e</samp>&rsquo;, &lsquo;<samp>%f</samp>&rsquo;, &lsquo;<samp>%g</samp>&rsquo;, and if
both flags are used, &lsquo;<samp>+</samp>&rsquo; takes precedence.
</p>
<p>The flag &lsquo;<samp>#</samp>&rsquo; specifies an alternate form which depends on
the format in use.  For &lsquo;<samp>%o</samp>&rsquo;, it ensures that the result begins
with a &lsquo;<samp>0</samp>&rsquo;.  For &lsquo;<samp>%x</samp>&rsquo; and &lsquo;<samp>%X</samp>&rsquo;, it prefixes nonzero results
with &lsquo;<samp>0x</samp>&rsquo; or &lsquo;<samp>0X</samp>&rsquo;.  For &lsquo;<samp>%e</samp>&rsquo; and &lsquo;<samp>%f</samp>&rsquo;, the
&lsquo;<samp>#</samp>&rsquo; flag means include a decimal point even if the precision is
zero.  For &lsquo;<samp>%g</samp>&rsquo;, it always includes a decimal point, and also
forces any trailing zeros after the decimal point to be left in place
where they would otherwise be removed.
</p>
<p>The flag &lsquo;<samp>0</samp>&rsquo; ensures that the padding consists of &lsquo;<samp>0</samp>&rsquo;
characters instead of spaces.  This flag is ignored for non-numerical
specification characters like &lsquo;<samp>%s</samp>&rsquo;, &lsquo;<samp>%S</samp>&rsquo; and &lsquo;<samp>%c</samp>&rsquo;.
These specification characters accept the &lsquo;<samp>0</samp>&rsquo; flag, but still pad
with <em>spaces</em>.
</p>
<p>The flag &lsquo;<samp>-</samp>&rsquo; causes any padding inserted by the width,
if specified, to be inserted on the right rather than the left.
If both &lsquo;<samp>-</samp>&rsquo; and &lsquo;<samp>0</samp>&rsquo; are present, the &lsquo;<samp>0</samp>&rsquo; flag is
ignored.
</p>
<div class="example">
<pre class="example">(format &quot;%06d is padded on the left with zeros&quot; 123)
     &rArr; &quot;000123 is padded on the left with zeros&quot;

(format &quot;'%-6d' is padded on the right&quot; 123)
     &rArr; &quot;'123   ' is padded on the right&quot;

(format &quot;The word '%-7s' actually has %d letters in it.&quot;
        &quot;foo&quot; (length &quot;foo&quot;))
     &rArr; &quot;The word 'foo    ' actually has 3 letters in it.&quot;
</pre></div>

<span id="index-field-width"></span>
<span id="index-padding"></span>
<p>A specification can have a <em>width</em>, which is a decimal number
that appears after any field number and flags.  If the printed
representation of the object contains fewer characters than this
width, <code>format</code> extends it with padding.  Any padding introduced by
the width normally consists of spaces inserted on the left:
</p>
<div class="example">
<pre class="example">(format &quot;%5d is padded on the left with spaces&quot; 123)
     &rArr; &quot;  123 is padded on the left with spaces&quot;
</pre></div>

<p>If the width is too small, <code>format</code> does not truncate the
object&rsquo;s printed representation.  Thus, you can use a width to specify
a minimum spacing between columns with no risk of losing information.
In the following two examples, &lsquo;<samp>%7s</samp>&rsquo; specifies a minimum width
of 7.  In the first case, the string inserted in place of &lsquo;<samp>%7s</samp>&rsquo;
has only 3 letters, and needs 4 blank spaces as padding.  In the
second case, the string <code>&quot;specification&quot;</code> is 13 letters wide but
is not truncated.
</p>
<div class="example">
<pre class="example">(format &quot;The word '%7s' has %d letters in it.&quot;
        &quot;foo&quot; (length &quot;foo&quot;))
     &rArr; &quot;The word '    foo' has 3 letters in it.&quot;
(format &quot;The word '%7s' has %d letters in it.&quot;
        &quot;specification&quot; (length &quot;specification&quot;))
     &rArr; &quot;The word 'specification' has 13 letters in it.&quot;
</pre></div>

<span id="index-precision-in-format-specifications"></span>
<p>All the specification characters allow an optional <em>precision</em>
after the field number, flags and width, if present.  The precision is
a decimal-point &lsquo;<samp>.</samp>&rsquo; followed by a digit-string.  For the
floating-point specifications (&lsquo;<samp>%e</samp>&rsquo; and &lsquo;<samp>%f</samp>&rsquo;), the
precision specifies how many digits following the decimal point to
show; if zero, the decimal-point itself is also omitted.  For
&lsquo;<samp>%g</samp>&rsquo;, the precision specifies how many significant digits to show
(significant digits are the first digit before the decimal point and
all the digits after it).  If the precision of %g is zero or
unspecified, it is treated as 1.  For &lsquo;<samp>%s</samp>&rsquo; and &lsquo;<samp>%S</samp>&rsquo;, the
precision truncates the string to the given width, so &lsquo;<samp>%.3s</samp>&rsquo;
shows only the first three characters of the representation for
<var>object</var>.  For other specification characters, the effect of
precision is what the local library functions of the <code>printf</code>
family produce.
</p>
<span id="index-formatting-numbers-for-rereading-later"></span>
<p>If you plan to use <code>read</code> later on the formatted string to
retrieve a copy of the formatted value, use a specification that lets
<code>read</code> reconstruct the value.  To format numbers in this
reversible way you can use &lsquo;<samp>%s</samp>&rsquo; and &lsquo;<samp>%S</samp>&rsquo;, to format just
integers you can also use &lsquo;<samp>%d</samp>&rsquo;, and to format just nonnegative
integers you can also use &lsquo;<samp>#x%x</samp>&rsquo; and &lsquo;<samp>#o%o</samp>&rsquo;.  Other formats
may be problematic; for example, &lsquo;<samp>%d</samp>&rsquo; and &lsquo;<samp>%g</samp>&rsquo; can mishandle
NaNs and can lose precision and type, and &lsquo;<samp>#x%x</samp>&rsquo; and &lsquo;<samp>#o%o</samp>&rsquo;
can mishandle negative integers.  See <a href="Input-Functions.html">Input Functions</a>.
</p>
<p>The functions described in this section accept a fixed set of
specification characters.  The next section describes a function
<code>format-spec</code> which can accept custom specification characters,
such as &lsquo;<samp>%a</samp>&rsquo; or &lsquo;<samp>%z</samp>&rsquo;.
</p>

<div class="header" style="background-color:#DDDDFF">
<p>
Next: <a href="Custom-Format-Strings.html" accesskey="n" rel="next">Custom Format Strings</a>, Previous: <a href="String-Conversion.html" accesskey="p" rel="prev">String Conversion</a>, Up: <a href="Strings-and-Characters.html" accesskey="u" rel="up">Strings and Characters</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
